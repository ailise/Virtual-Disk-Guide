<chapter xmlns="http://docbook.org/ns/docbook" xml:id="VDI-Basics" version="5.0">

  <title>Basic Operations</title>

  <section xml:id="VDI-Basics-Create-Simple-Image">
    <title>Creating a simple image</title>

    <para> The simplest operation (next to deleting an image) you can do is
      creating a new virtual disk image. There are several options one could
      consider when creating an image: which format, to use encryption, to use
      compression, or even what existing image to base this new disk off of. In
      this example we will limit our concern to creating a simple basic image
      capable of being used as a boot disk for a qemu/kvm virtual machine. The
      resulting image will not be able to be mounted on your local filesystem
      without additional work, this is covered in the Advanced Operations
      section below. </para>

    <!-- Make that a link to the advanced section -->

    <screen>
tbielawa@fridge:~$ qemu-img create /srv/images/webserver.raw 10G
Formatting '/srv/images/websserver.raw', fmt=raw, size=10485760 kB
    </screen>

    <!-- make terms like 'raw' and etc. link to a relavant section where they are defined -->
    <para> From the 'fmt' description above we can tell that the type of virtual
      disk crated is 'raw'. Likewise, we can confirm from the output that the
      size of the created disk is 10 gigabytes. </para>

    <para> </para>
  </section>

  <section xml:id="VDI-Basics-Retrieve-Information">
    <title>Retreiving information about an existing image</title>

    <para> How to get more information about a disk image. </para>

    <example xml:id="VDI-Basics-qemu-img_info-Example">
      <title><command>qemu-img</command>
        <option>info</option> usage</title>

      <programlisting>
tbielawa@fridge:~$ qemu-img info /srv/images/webserver.raw 
image: /srv/images/webserver.raw
file format: raw
virtual size: 10G (10737418240 bytes)
disk size: 0
      </programlisting>
    </example>

    <para> The information provided with the <option>info</option> option is
      pretty sparse but helpful. You will find that that if you're using a
      filesystem that supports files with holes in them, and the qcow image
      format type, that the filesize supplied by the <command>ls</command>
      command does not match the size you have made the file. Using
        <command>qemu-img</command>
      <option>info</option> will correctly provide the virtual disks size. </para>

    <para> Additionally, the disk size field above shows the actual space used
      on your hard disk by the virtual disk. This is similar to using the
        <command>ls</command> command with the <option>-s</option> option.
    </para>
  </section>

  <section xml:id="VDI-Basics-Mounting-A-Disk-Image">
    <title>Mounting a Disk Image</title>

    <para> Mounting a disk image is fairly trivial if you're using a format
      without holes in it, like raw which we used above. Use the <command
        linkend="VDI-Basics-qemu-img_info-Example">qemu-img</command> command to
      find out what kind you're using if you're not sure. Additional caveat, the
      image can only contain one partition, Disks with multiple partitions will
      be discussed in the Advanced Virtual Disk Operations section below. </para>

    <!-- Turn "Advanced ..." into a link to the section when it's created -->

    <example xml:id="VDI-Basics-Mounting-A-Disk-Image-Example">
      <title>Mounting a Disk Image</title>

      <programlisting>
tbielawa@fridge:~$ mkdir /tmp/image
tbielawa@fridge:~$ mount -o loop /srv/storage/webserver.img /tmp/image
tbielawa@fridge:~$ 
      </programlisting>

      <!-- FINISH THIS EXAMPLE!!!! -->
    </example>
  </section>
</chapter>
